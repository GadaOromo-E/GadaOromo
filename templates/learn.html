<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Learn | {{ APP_NAME }}</title>

  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

  <!-- ‚úÖ PWA -->
  <link rel="manifest" href="{{ url_for('static', filename='manifest.webmanifest') }}">
  <meta name="theme-color" content="#0b5cff">

  <!-- ‚úÖ iOS -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="{{ APP_NAME }}">
  <link rel="apple-touch-icon" href="{{ url_for('static', filename='icons/apple-touch-icon.png') }}">

  <link rel="icon" href="{{ url_for('static', filename='icons/icon-192.png') }}">
</head>
<body>

<!-- OPTIONAL: tiny splash overlay (native feel) -->
<div id="bootSplash" style="position:fixed; inset:0; background:#fff; display:flex; align-items:center; justify-content:center; z-index:2000;">
  <div style="text-align:center;">
    <div style="font-size:42px;">üìò</div>
    <div style="margin-top:8px; font-weight:700;">{{ APP_NAME }}</div>
    <div class="muted" style="margin-top:6px;">Loading‚Ä¶</div>
  </div>
</div>
<script>
  window.addEventListener("load", () => {
    const el = document.getElementById("bootSplash");
    if (el) el.style.display = "none";
  });
</script>

<!-- PWA Update Bar -->
<div id="pwaUpdateBar" class="card" style="display:none; position:sticky; top:0; z-index:999; margin:0; border-radius:0;">
  <div style="display:flex; align-items:center; justify-content:space-between; gap:12px;">
    <div>
      <b>Update available</b>
      <div class="muted" style="font-size:14px;">Reload to get the latest version.</div>
    </div>
    <div style="display:flex; gap:8px;">
      <button class="btn primary" type="button" data-reload>Reload</button>
      <button class="btn" type="button" data-close>Later</button>
    </div>
  </div>
</div>

<!-- iOS Install Help -->
<div id="iosInstallHelp" class="card" style="display:none; margin-top:10px;">
  <b>Install on iPhone</b>
  <div class="muted" style="margin-top:6px; line-height:1.5;">
    Tap <b>Share</b> (‚¨ÜÔ∏è) ‚Üí <b>Add to Home Screen</b>.
  </div>
</div>

<!-- Toast -->
<div id="pwaToast" class="card" style="display:none; position:fixed; left:12px; right:12px; bottom:12px; z-index:1000;">
  <span data-msg></span>
</div>

<div class="container">

  <header class="topbar">
    <div class="title-row">
      <div class="brand">
        <h1 style="margin:0;">{{ APP_NAME }}</h1>
        <p class="tagline">Learn Afaan Oromo ‚Üî English</p>

        <div class="small-actions" style="margin-top:10px; display:flex; flex-wrap:wrap; gap:8px;">
          <a class="btn" href="/">üè† Home</a>
          <a class="btn" href="/translate">üåç Translate</a>
          <a class="btn primary" href="/learn">üìö Learn</a>
          <a class="btn danger" href="/support">‚ù§Ô∏è Donate</a>

          <!-- ‚úÖ Install button -->
          <button id="installBtn" class="btn primary" type="button" style="display:none;">‚¨áÔ∏è Install App</button>
        </div>
      </div>
    </div>
  </header>

  <nav class="nav">
    <a class="nav-link" href="/">Home</a>
    <a class="nav-link" href="/translate">Translate</a>
    <a class="nav-link" href="/learn">Learn</a>
    <a class="nav-link" href="/support">Donate</a>
    <a class="nav-link" href="/submit">Submit Word</a>
    <a class="nav-link" href="/submit_phrase">Submit Phrase</a>
  </nav>

  <section class="card">
    <h2>Practice</h2>
    <div class="subtle">
      Choose your learning direction, then practice with quick prompts.
    </div>

    <div class="row" style="margin-top:12px;">
      <select id="learnDirection">
        <option value="om_en">Oromo ‚Üí English</option>
        <option value="en_om">English ‚Üí Oromo</option>
      </select>
      <button type="button" onclick="openTranslator()">Start Practice</button>
    </div>

    <div class="divider"></div>

    <h2>Quick Practice Cards</h2>
    <div class="subtle">
      Tap a card to open it in the Translator.
    </div>

    {% if words and words|length > 0 %}
      <div class="chips" style="margin-top:12px;">
        {% for w in words[:40] %}
          <span class="chip" onclick="practiceWord('{{ w[1]|e }}', '{{ w[2]|e }}')">
            {{ w[1] }} <span class="muted">‚Üí</span> {{ w[2] }}
          </span>
        {% endfor %}
      </div>

      <div class="small-actions" style="margin-top:12px;">
        <button type="button" class="btn" onclick="shuffleTip()">üîÄ More Random</button>
        <a class="btn" href="/translate">Open Translator</a>
      </div>

      <div id="tip" class="muted" style="margin-top:10px;"></div>
    {% else %}
      <p class="muted" style="margin-top:10px;">
        No approved words loaded here yet. (Optional) Update /learn route to pass words to this page.
      </p>
      <div class="small-actions" style="margin-top:10px;">
        <a class="btn" href="/translate">Open Translator</a>
        <a class="btn" href="/submit">Submit Word</a>
      </div>
    {% endif %}
  </section>

  <section class="card">
    <h2>Learning plan (simple)</h2>
    <div class="subtle">No accounts needed. Just practice every day.</div>

    <div style="margin-top:10px; line-height:1.5;">
      <p><b>Day 1‚Äì3:</b> Learn 10 common words/day</p>
      <p><b>Day 4‚Äì7:</b> Learn 5 phrases/day + listen to pronunciation</p>
      <p><b>Week 2:</b> Practice short sentences (use Translator)</p>
      <p><b>Oromo audio:</b> If you can, record pronunciation to help the community.</p>
    </div>
  </section>

  {% if trending %}
    <section class="card">
      <h2>üî• Trending searches</h2>
      <div class="chips" style="margin-top:10px;">
        {% for row in trending %}
          <span class="chip" onclick="openTranslatorWithText('{{ row[0]|e }}')">{{ row[0] }}</span>
        {% endfor %}
      </div>
      <div class="subtle" style="margin-top:8px;">Tap a word to practice it in Translator.</div>
    </section>
  {% endif %}

  <footer class="footer">
    <p>¬© 2026 GadaOromo ‚Äî Open community dictionary</p>
  </footer>

</div>

<script>
function openTranslator(){
  const dir = document.getElementById("learnDirection").value || "om_en";
  window.location.href = "/translate?direction=" + encodeURIComponent(dir);
}
function openTranslatorWithText(text){
  const dir = document.getElementById("learnDirection").value || "om_en";
  const url = "/translate?direction=" + encodeURIComponent(dir) + "&text=" + encodeURIComponent(text);
  window.location.href = url;
}
function practiceWord(en, om){
  const dir = document.getElementById("learnDirection").value || "om_en";
  const text = (dir === "om_en") ? om : en;
  const url = "/translate?direction=" + encodeURIComponent(dir) + "&text=" + encodeURIComponent(text);
  window.location.href = url;
}
function shuffleTip(){
  const tip = document.getElementById("tip");
  tip.textContent = "Tip: Reload the page to see a different set of practice cards.";
}
</script>

<!-- ‚úÖ PWA UI: install button + iOS help + update prompt + SW registration -->
<script src="{{ url_for('static', filename='pwa-ui.js') }}"></script>

</body>
</html>



