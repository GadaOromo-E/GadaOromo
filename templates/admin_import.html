<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Import Words | Admin</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>
<div class="container">

  <div class="topbar">
    <div class="title-row">
      <div>
        <h2 style="margin:0;">üì• Admin Import (English ‚Üí Oromo)</h2>
        <div class="subtle">
          One-click import: upload a file and click Import. Up to <b>2000</b> English words will be translated using
          <b>Google Translate API</b> (server-side) in <b>10</b> calls (batch size <b>200</b>).
          Imported words are saved as <b>pending</b> for approval.
        </div>
      </div>
      <a class="btn danger" href="/dashboard">‚¨Ö Back</a>
    </div>
  </div>

  {% if msg %}
    <div class="result-box" id="resultBox">{{ msg }}</div>
  {% endif %}

  <div class="card">
    <form id="importForm" method="POST" action="/admin/import" enctype="multipart/form-data" novalidate autocomplete="off">

      <label class="subtle" style="display:block; margin-bottom:6px;">Choose File (TXT / CSV / XLSX)</label>
      <input id="fileInput" type="file" name="file" accept=".txt,.csv,.xlsx" required>

      <div id="fileName" class="muted" style="margin-top:8px; font-size:14px;"></div>

      <div style="height:14px;"></div>

      <button id="importBtn" type="submit">üöÄ Import Now</button>
      <div id="statusLine" class="muted" style="margin-top:10px; font-size:14px;"></div>
    </form>

    <div class="muted" style="margin-top:12px; font-size:14px; line-height:1.6;">
      <b>File rules (English-only list):</b><br>
      ‚Ä¢ <b>TXT</b>: one English word per line<br>
      ‚Ä¢ <b>CSV</b>: header <code>english</code> (recommended) or first column is used<br>
      ‚Ä¢ <b>XLSX</b>: Column A = English (first row may be header ‚ÄúEnglish‚Äù)<br><br>

      <b>Important:</b> This import works only if the server has <code>GOOGLE_TRANSLATE_API_KEY</code> set.
      After importing, go to <b>Dashboard</b> to approve/reject.
    </div>
  </div>

</div>

<script>
  (function () {
    const form = document.getElementById("importForm");
    const btn = document.getElementById("importBtn");
    const status = document.getElementById("statusLine");
    const fileInput = document.getElementById("fileInput");
    const fileName = document.getElementById("fileName");

    if (!form || !btn || !status || !fileInput || !fileName) return;

    fileInput.addEventListener("change", function () {
      if (fileInput.files && fileInput.files.length > 0) {
        fileName.textContent = "Selected: " + fileInput.files[0].name;
        status.textContent = "";
      } else {
        fileName.textContent = "";
      }
    });

    form.addEventListener("submit", function (e) {
      if (!fileInput.files || fileInput.files.length === 0) {
        e.preventDefault();
        status.textContent = "Please choose a TXT / CSV / XLSX file first.";
        return;
      }

      // Prevent double submit
      btn.disabled = true;
      btn.textContent = "Importing‚Ä¶";
      status.textContent = "Uploading file, translating in 200√ó10 batches, saving as pending‚Ä¶";
    });
  })();
</script>

</body>
</html>



